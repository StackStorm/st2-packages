#!/bin/sh
# postinst script for st2
#
# see: dh_installdeb(1)

set -e
ST2_USER=st2
SYS_USER=stanley

PERMS=$(cat <<EHD
/etc/st2/htpasswd             ${ST2_USER}:${ST2_USER} 600
/opt/stackstorm/exports       ${ST2_USER}:${ST2_USER} 755
/opt/stackstorm/packs         ${SYS_USER}:${ST2_USER} 775
/opt/stackstorm/virtualenvs   ${SYS_USER}:${ST2_USER} 775
/var/log/st2                  ${ST2_USER}:${ST2_USER} 775
EHD
)

echo "$PERMS" | while read line; do
  path=`echo $line | cut -f1 -d' '`
  creds=`echo $line | cut -f2 -d' '`
  mode=`echo $line | cut -f3 -d' '`
  chown -f $creds $path && chmod -f $mode $path
done

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

exit 0
